---
name: Contradiction Detection UI
status: open
created: 2025-10-14T21:12:26Z
updated: 2025-10-14T21:12:26Z
github: null
depends_on: [003]
parallel: true
conflicts_with: []
---

# Contradiction Detection UI

## Description

Implement a user-facing UI to display contradiction alerts and provide resolution flows. This task leverages the existing `detectContradictions()` utility from Wave 0.2 (located in `src/lib/ai/utils/contradiction.ts`) to surface conflicting memories and allow users to reconcile them.

The UI should present contradictions in a non-intrusive manner while ensuring users can easily understand and resolve conflicts between their memories.

## Acceptance Criteria

- [ ] Alert banner appears when contradictions are detected between memories
- [ ] Contradiction details clearly show conflicting memories side-by-side
- [ ] Users can choose resolution options: keep both, merge, or select one
- [ ] Resolved contradictions are marked and no longer trigger alerts
- [ ] Integration with existing `detectContradictions()` from `src/lib/ai/utils/contradiction.ts`
- [ ] UI is accessible (keyboard navigation, screen reader friendly)
- [ ] Visual design matches Lumara's design system
- [ ] Loading states during contradiction detection
- [ ] Empty state when no contradictions exist
- [ ] Unit tests for contradiction resolution logic
- [ ] Integration tests for UI components

## Technical Details

### Implementation Approach

1. **Contradiction Banner Component**
   - Create `ContradictionAlert.tsx` component
   - Display at top of memory/chat view when contradictions detected
   - Show count and severity of contradictions
   - Click to expand and view details

2. **Contradiction Resolution Modal**
   - Create `ContradictionResolutionModal.tsx`
   - Display conflicting memories with timestamps
   - Show AI-generated explanation of conflict
   - Provide action buttons: "Keep Both", "Merge", "Select One"

3. **State Management**
   - Add contradiction state to memory store
   - Track resolved contradictions to avoid re-triggering
   - Update memory metadata when contradictions resolved

4. **Integration with Wave 0.2 Utility**
   ```typescript
   // Use existing detectContradictions from:
   import { detectContradictions } from '@/lib/ai/utils/contradiction';

   // Call after memory creation/update
   const contradictions = await detectContradictions(memories);
   ```

5. **API Integration**
   - Add endpoint to mark contradictions as resolved
   - Update memory records with resolution metadata
   - Persist resolution choices

### Files to Create/Modify

- `src/components/contradiction/ContradictionAlert.tsx` (new)
- `src/components/contradiction/ContradictionResolutionModal.tsx` (new)
- `src/hooks/useContradictions.ts` (new)
- `src/stores/memoryStore.ts` (modify - add contradiction state)
- `src/lib/api/contradictions.ts` (new - API calls)

### Design Considerations

- **Non-intrusive**: Alert should be noticeable but not blocking
- **Clear explanation**: Users should understand what's conflicting and why
- **Simple resolution**: Minimize cognitive load during resolution
- **Preserve history**: Keep audit trail of resolved contradictions

## Dependencies

**Depends on:**
- Task 003 (Memory Management UI) - requires memory display and interaction patterns

**Leverages:**
- Wave 0.2 `detectContradictions()` utility - existing contradiction detection logic

**Parallel with:**
- Task 005 (Memory Recall Integration)
- Task 006 (Reflection Prompts UI)

## Effort Estimate

**Total: 1 day (8 hours)**

- Contradiction alert component: 2 hours
- Resolution modal component: 2 hours
- State management integration: 1.5 hours
- API integration: 1 hour
- Testing and polish: 1.5 hours

## Definition of Done

- [ ] Contradiction alert banner displays when `detectContradictions()` finds conflicts
- [ ] Resolution modal allows users to resolve contradictions with clear options
- [ ] All resolution actions persist to backend and update UI state
- [ ] Resolved contradictions no longer trigger alerts
- [ ] Component is accessible (WCAG 2.1 AA compliant)
- [ ] Unit tests achieve >80% coverage
- [ ] Integration tests verify contradiction detection and resolution flow
- [ ] Code reviewed and approved
- [ ] Documentation updated in component comments
- [ ] Verified in browser with Chrome DevTools (no console errors)
- [ ] Manual testing completed for all resolution paths
