---
name: Set Up Data Persistence Layer (Dexie)
status: open
created: 2025-10-13T19:38:52Z
updated: 2025-10-13T19:44:05Z
github: https://github.com/tgarrochinho/lumara-frontend/issues/6
depends_on: [4]
parallel: true
conflicts_with: []
---

# Task: Set Up Data Persistence Layer (Dexie)

## Description

Install and configure Dexie.js for IndexedDB management. Create the database configuration file with basic schema structure (empty for now) and export a typed database instance. Verify that IndexedDB connection works properly in the browser.

This establishes the foundation for local-first data persistence without requiring a backend. Dexie provides a clean TypeScript-friendly API over IndexedDB's complexity.

## Acceptance Criteria

- [ ] Dexie.js and dexie-react-hooks installed and saved to package.json
- [ ] `src/lib/db.ts` created with database configuration
- [ ] Database instance exported with proper TypeScript typing
- [ ] Basic schema structure defined (even if empty/minimal)
- [ ] Can verify database appears in Browser DevTools → Application → IndexedDB
- [ ] Database version management set up correctly
- [ ] No console errors when database initializes

## Technical Details

**Installation:**
```bash
npm install dexie dexie-react-hooks
```

**File to create:** `src/lib/db.ts`

**Required elements:**
- Import Dexie
- Extend Dexie class for typed database
- Define database schema (can be minimal/empty for now)
- Set database version
- Export singleton database instance
- Add TypeScript interfaces for type safety

**Example structure:**
```typescript
import Dexie, { Table } from 'dexie';

// Define your database schema
export class LumaraDatabase extends Dexie {
  // Define tables here (empty for now, will add later)

  constructor() {
    super('LumaraDB');
    this.version(1).stores({
      // Schema will be defined here
    });
  }
}

// Export singleton instance
export const db = new LumaraDatabase();
```

**Validation steps:**
1. Import db in App.tsx temporarily
2. Run dev server
3. Open Browser DevTools → Application → IndexedDB
4. Verify "LumaraDB" appears in the list
5. No console errors related to IndexedDB

## Dependencies

- [ ] Task 002 (TypeScript configuration) must be complete for proper typing
- [ ] Node.js and npm working
- [ ] Vite dev server can run
- [ ] Modern browser with IndexedDB support

## Effort Estimate

- Size: S
- Hours: 3 hours
- Parallel: true (independent of Zustand/TanStack Query setup)

**Breakdown:**
- Installation: 15 minutes
- Create db.ts with basic structure: 1 hour
- TypeScript typing and interfaces: 45 minutes
- Testing and validation: 45 minutes
- Documentation comments: 15 minutes

## Definition of Done

- [ ] Code implemented and follows TypeScript strict mode
- [ ] Database singleton exported from src/lib/db.ts
- [ ] Can import and use db instance without errors
- [ ] IndexedDB visible in browser DevTools
- [ ] Code has JSDoc comments explaining usage
- [ ] No TypeScript errors (npm run type-check passes)
- [ ] No console errors when dev server runs
- [ ] Git commit made with clear message
